<% content_for :title, "My Game Attempts" %>

<%= tag.div class: "game-attempts-container" do %>
  <%= tag.div class: "game-attempts-header" do %>
    <%= tag.h1 "My Game Attempts", class: "game-attempts-title" %>
    <%= tag.p "View your past game attempts and track your progress", class: "game-attempts-subtitle" %>
  <% end %>
  
  <% if @teams.any? %>
    <%= tag.div class: "teams-navigation" do %>
      <%= tag.h2 "Teams", class: "teams-navigation-title" %>
      <%= tag.div class: "teams-grid" do %>
        <% @teams.each do |team| %>
          <%= tag.div class: "team-stats-card" do %>
            <%= link_to team_strength_game_attempts_path(team), class: "team-stats-link" do %>
              <%= tag.div class: "team-stats-header" do %>
                <%= tag.div class: "team-logo-container" do %>
                  <% if team.logo_url.present? %>
                    <%= tag.img src: team.logo_url, alt: "#{team.name} logo", class: "team-logo" %>
                  <% else %>
                    <%= tag.div class: "team-logo-placeholder" do %>
                      <%= tag.i class: "fa-solid fa-shield-alt" %>
                    <% end %>
                  <% end %>
                <% end %>
                <%= tag.h3 team.name, class: "team-name" %>
              <% end %>
              <%= tag.div class: "team-stats-details" do %>
                <%= tag.div class: "team-stats-item" do %>
                  <%= tag.span "#{@team_stats[team][:correct_attempts]}/#{@team_stats[team][:total_attempts]}", class: "team-stats-value" %>
                  <%= tag.span "correct", class: "team-stats-label" %>
                <% end %>
                <%= tag.div class: "team-stats-item" do %>
                  <%= tag.span "#{@team_stats[team][:accuracy]}%", class: "team-stats-value" %>
                  <%= tag.span "accuracy", class: "team-stats-label" %>
                <% end %>
              <% end %>
            <% end %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>

  <%= tag.div class: "game-attempts-panel" do %>
    <%= tag.div class: "game-attempts-content" do %>
      <% if @game_attempts.any? %>
        <%= tag.div class: "attempts-grid" do %>
          <% @game_attempts.each do |attempt| %>
            <%= tag.div class: "attempt-card #{attempt.correct? ? 'correct-attempt' : 'incorrect-attempt'}" do %>
              <%= tag.div class: "attempt-team-part" do %>
                <%= tag.div class: "attempt-team-logo-container" do %>
                  <%= display_name_with_lazy_logo(attempt.target_entity) %>
                <% end %>
                <%= tag.p attempt.target_entity.name, class: "attempt-team-name" %>
              <% end %>
              
              <%= tag.div class: "attempt-player-part" do %>
                <%= tag.div class: "attempt-player-photo-container" do %>
                  <%= display_name_with_lazy_logo(attempt.subject_entity) %>
                <% end %>
                <%= tag.p attempt.subject_entity.full_name, class: "attempt-player-name" %>
              <% end %>
              <% unless attempt.correct? %>
                <%= tag.div class: "chosen-team-indicator" do %>
                  Your Guess: <%= attempt.chosen_entity.name %>
                <% end %>
              <% end %>
              <%= tag.div class: "attempt-timestamp" do %>
                <%= time_ago_in_words(attempt.created_at) %> ago
              <% end %>
            <% end %>
          <% end %>
        <% end %>
      <% else %>
        <%= tag.div class: "empty-attempts-message" do %>
          <%= tag.p "You haven't made any game attempts yet.", class: "empty-attempts-text" %>
          <%= link_to "Start Playing", strength_team_match_path, class: "start-playing-button" %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
<% end %> 