<% content_for :title, @division.present? ? "#{@division.name} Division Quiz - Team Match" : "Team Match - Strength Training" %>

<div class="flex flex-col lg:flex-row lg:gap-x-8" 
     data-controller="team-match"
     data-team-match-player-id-value="<%= @current_player.id %>" 
     data-team-match-correct-team-id-value="<%= @correct_team.id %>"> 

  <div class="lg:w-1/3 mb-4 lg:mb-0"> 
    <!-- Static Player Card Area -->
    <div class="mb-4" data-team-match-target="currentPlayerCardDisplay"> 
      <%= player_card @current_player %>
    </div>
  </div> 

  <div class="lg:w-2/3"> 
    <%= turbo_frame_tag "team_match_game" do %>
      <div class="team-match-container">
        
        <div class="filter-indicators mb-4">
          <%= teams_filter_label @parent %>
        </div>

        <div class="team-match-game" data-team-match-target="gameContainer">
          <%= team_choice_group @team_choices, @correct_team.id %>

          <!-- Floating team name overlay (hidden by default) -->
          <div class="team-name-overlay fixed inset-0 flex items-center justify-center pointer-events-none opacity-0 z-50" data-team-match-target="teamNameOverlay">
            <div class="team-name-content text-8xl font-extrabold text-center text-white text-shadow-lg">
              <span data-team-match-target="teamNameText"></span>
            </div>
          </div>

          <!-- Controls -->
          <div class="controls flex justify-between items-center mt-8">
            <div class="progress">
              <span class="text-gray-600">Progress: <span data-team-match-target="progressCounter">0</span> correct</span>
            </div>
            <%= pause_button "team-match" %>
          </div>
        </div>

        <!-- Last Attempt Details Area -->
        <div data-team-match-target="lastAttemptContainer" class="mt-8 p-4 border border-gray-200 rounded-lg shadow-sm hidden">
          <h3 class="text-lg font-semibold mb-3 text-center text-gray-700">Most Recent Attempt:</h3>
          <div class="flex flex-col md:flex-row items-stretch justify-center md:gap-x-6 gap-y-4">
            
            <!-- Player Display Area -->
            <div data-team-match-target="lastAttemptPlayerCard" class="p-3 border rounded-md w-full md:w-auto flex-shrink-0">
              <!-- Player card/info will be injected here by JS -->
              <p class="text-sm text-gray-400 italic text-center">Player details will appear here.</p>
            </div>
            
            <div class="flex items-center justify-center text-2xl font-semibold text-gray-500">
              <span class="hidden md:inline">â†’</span>
              <span class="md:hidden">Selected:</span>
            </div>
            
            <!-- Chosen Team Display Area -->
            <div data-team-match-target="lastAttemptChosenTeamDisplay" class="p-3 border rounded-md text-center w-full md:w-auto flex-shrink-0">
              <img data-team-match-target="lastAttemptChosenTeamLogo" src="" alt="Chosen Team Logo" class="mx-auto h-16 w-16 object-contain mb-2 hidden">
              <p data-team-match-target="lastAttemptChosenTeamLogoPlaceholder" class="text-gray-500 text-sm my-2">Chosen team</p>
              <p data-team-match-target="lastAttemptChosenTeamName" class="text-lg font-bold"></p>
            </div>
          </div>
        </div>

      </div> 
    <% end %>
  </div> 

</div> 
